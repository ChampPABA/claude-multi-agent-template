# CLAUDE.md

> **Navigation Hub for AI Agents**
> **Template Version:** 1.3.0 - Universal Multi-Agent Template
> **Latest:** TaskMaster Integration - Intelligent task analysis with complexity, dependencies, risk assessment

---

## ğŸ¯ What is This Template?

Universal, framework-agnostic template for AI-assisted development.

**What's Included:**
- âœ… 6 Specialized Agents (integration + 5 domain specialists)
- âœ… Universal Patterns (logging, testing, error-handling, agent selection)
- âœ… Design Foundation (color theory, spacing, typography)
- âœ… **Auto-Generated Best Practices** (from Context7 MCP per project)
- âœ… **3-Level Indexing** (agents auto-discover project context)
- âœ… Domain-Specific Support (add your business logic)

**What's NOT Included:**
- âŒ Framework patterns â†’ Generated dynamically via `/agentsetup`
- âŒ Package managers â†’ Detected by `/agentsetup`
- âŒ Spec frameworks â†’ Optional (OpenSpec, BMAD, SpecKit)

---

## ğŸ“– Quick Navigation

**Design/UI:**
- `/designsetup` - Auto-generate style guide from reference/codebase/AI
- `design-system/STYLE_TOKENS.json` - **NEW!** Lightweight design tokens (~500 tokens) âœ¨
- `design-system/STYLE_GUIDE.md` - Full style guide (17 sections, ~5000 tokens)
- `@/.claude/lib/document-loader.md` - **NEW!** Token-efficient loading patterns âœ¨
- `@/.claude/contexts/design/index.md` (General design principles - fallback)
- `@/.claude/contexts/design/box-thinking.md` (Layout analysis)
- `@/.claude/contexts/patterns/ui-component-consistency.md` (Visual consistency)

**Development:**
- `@/.claude/contexts/patterns/task-classification.md` (Agent selection guide)
- `@/.claude/contexts/patterns/agent-coordination.md` (When to run agents parallel/sequential)
- `@/.claude/contexts/patterns/error-recovery.md` (How agents handle errors & escalate)
- `@/.claude/contexts/patterns/logging.md`
- `@/.claude/contexts/patterns/testing.md`
- `@/.claude/contexts/patterns/task-breakdown.md`
- `@/.claude/contexts/patterns/frontend-component-strategy.md`

**Project Setup:**
- `/designsetup` - **NEW!** Auto-generate style guide (reference â†’ codebase â†’ AI)
- `/psetup` - One-time project setup (detect tech stack, generate best practices)
- `/agentsetup` - Auto-detect tech stack and generate best practices

**Page Planning (UI Tasks):**
- `/pageplan @prd.md @brief.md` - **NEW!** Generate page structure & content plan for UI tasks
- Output: `.changes/{id}/page-plan.md` (component reuse, content draft, asset checklist)
- Used by: uxui-frontend agent (auto-reads in STEP 0.5)

**OpenSpec Multi-Agent Workflow:**
- `/csetup {change-id}` - Setup change context (analyze tasks, generate workflow)
- `/cdev {change-id}` - Start/continue multi-agent development
- `/cview {change-id}` - View detailed progress for a change
- `/cstatus {change-id}` - Quick progress status for a change

**Best Practices (Dynamic):**
- `.claude/contexts/domain/{project}/best-practices/` (generated by `/agentsetup`)
- Framework-specific guidelines from Context7 MCP

**Indexing (3 Levels):**
- Level 1: `.claude/contexts/domain/index.md` (Project Registry)
- Level 2: `.claude/contexts/domain/{project}/README.md` (Project Overview)
- Level 3: `.claude/contexts/domain/{project}/best-practices/index.md` (Best Practices Registry)

**ğŸ†• Implementation Logic (v1.1.0):**
- `@/.claude/lib/README.md` - Implementation logic overview
- `@/.claude/lib/agent-executor.md` - Agent retry & escalation logic (used by /cdev)
- `@/.claude/lib/tdd-classifier.md` - TDD classification logic (used by /csetup)
- `@/.claude/lib/flags-updater.md` - ğŸ†• Progress tracking protocol (Main Claude updates flags.json)
- `@/.claude/lib/agent-router.md` - ğŸ†• Mandatory agent routing rules (enforce delegation)
- `@/.claude/contexts/patterns/agent-discovery.md` - Shared agent discovery flow

---

## ğŸ“š Best Practices System

**â†’ See:** `@/.claude/lib/detailed-guides/best-practices-system.md` for complete guide

**Quick Summary:**
- Run `/agentsetup` â†’ Auto-detects tech stack â†’ Queries Context7 â†’ Generates framework-specific best practices
- Files created in `.claude/contexts/domain/{project}/best-practices/` (React, Next.js, Prisma, etc.)
- Agents auto-discover via 3-level indexing (domain â†’ project â†’ best-practices)
- Enforces code quality with framework-specific patterns

---

## ğŸ¨ Design System / Style Guide Generation

**â†’ See:** `@/.claude/lib/detailed-guides/design-system.md` for complete guide

**Quick Summary:**
- `/designsetup` auto-detects project context with **3 smart paths**: Reference design â†’ Brownfield (reverse engineering) â†’ Greenfield (AI-generated)
- Generates comprehensive `design-system/STYLE_GUIDE.md` (17 sections: colors, typography, spacing, components, etc.)
- **uxui-frontend agent** auto-reads style guide (Priority #1) or falls back to general design principles
- Ensures visual consistency, prevents duplicates, enforces accessibility

---

## âš¡ Context Optimization (v1.2.0)

**â†’ See:** `@/.claude/lib/detailed-guides/context-optimization.md` for complete guide

**Quick Summary:**
- **Problem:** 20K tokens wasted (STYLE_GUIDE.md read 4x by different commands/agents)
- **Solution:** 3-tier loading â†’ STYLE_TOKENS.json (500 tokens) â†’ design-context.md (1K) â†’ STYLE_GUIDE.md (5K, selective)
- **Result:** 70% token reduction (~4.7K total), 3-4x faster, maintained quality

---

## ğŸ“‹ Page Planning System

**â†’ See:** `@/.claude/lib/detailed-guides/page-planning.md` for complete guide

**Quick Summary:**
- **Problem:** Agents duplicate components (Navbar 3x), use random colors, lorem ipsum content
- **Solution:** `/pageplan @prd.md @brief.md` â†’ Generates `.changes/{id}/page-plan.md` with component reuse plan, AI-drafted content, asset checklist
- **Benefits:** Prevents duplicates, ensures design consistency, real content from PRD, 25% faster (search done once upfront)
- **Use for:** Landing pages, dashboards, multi-section UI pages (skip for backend/database work)

---

## ğŸ§  TaskMaster-style Analysis (v1.3.0)

**â†’ See:** `@/.claude/lib/detailed-guides/taskmaster-analysis.md` for complete guide

**Quick Summary:**
- **Problem:** Dumb task lists treat all tasks equally â†’ no complexity/dependency/risk analysis â†’ tasks fail, delays, security issues
- **Solution:** `/csetup` uses **6 analysis dimensions**: Complexity (1-10), Dependencies (auto-detected), Risk (LOW/MEDIUM/HIGH), Research requirements, Subtask breakdown, Priority (0-100)
- **Benefits:** Intelligent phases.md with time buffers (+41%), auto-added research phases, dependency order, risk mitigation
- **Inspired by:** [claude-task-master](https://github.com/eyaltoledano/claude-task-master)

---

## ğŸ¤– Agent System

**â†’ See:** `@/.claude/lib/detailed-guides/agent-system.md` for complete guide

**Quick Summary:**
- **6 specialist agents**: integration (validate contracts), uxui-frontend (UI with mock data), test-debug (tests/bugs), frontend (connect UI to API), backend (API endpoints), database (schemas/migrations)
- **Main Claude's role**: Orchestrator (plan, coordinate, report), NOT implementer (no writing code directly)
- **Self-check protocol**: MANDATORY checklist before ANY work (detect work type â†’ select agent â†’ delegate)
- **Agent pre-work**: STEP 0 (project discovery for ALL) + STEP 1-5 (design fundamentals for uxui-frontend only)

**Example workflow:**
```
User: "Build login system"
â†’ Phase 1: uxui-frontend (UI)
â†’ Phase 2: backend + database (parallel)
â†’ Phase 2.5: integration (validate contracts)
â†’ Phase 3: frontend (connect UI to API)
â†’ Phase 4: test-debug (tests)

---

**ğŸ’¡ Remember:** This template is universal. Use Context7 for framework-specific docs!
